<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style/word.css">
    <title>Word</title>
    <style>

    </style>
</head>
<body>
    <div class="container">
        <div id="play"></div>
    </div>
    <p>Q = play , W = next word</p>
</body>
<script>

var play =  document.getElementById("play")
var playList = [
    "test",
    "go",
    "game",
    "result",
    "face",
    "pregnancy"
]
var url = ""
var nowWordNum = 0
inputWord()

function inputWord(){
    play.innerHTML = playList[nowWordNum]
    url = "https://www.ldoceonline.com/media/english/ameProns/"+playList[nowWordNum]+"1.mp3"
    url_2 = "https://www.ldoceonline.com/media/english/ameProns/"+playList[nowWordNum]+".mp3"
}

function nextWord(){
    if(nowWordNum==playList.length-1){
        nowWordNum=0
        inputWord()
    }
    else{
        nowWordNum = nowWordNum+1
        inputWord()
    }
    
}









var ctx = new AudioContext();

function loadSound(url,url_2) {
    var request = new XMLHttpRequest();
    request.open('GET', url, true);
    request.responseType = 'arraybuffer';
    // Decode asynchronously
    request.onload = function () {
        if(request.status == 404) {
            console.log("40")
            request.open('GET', url_2, true);
            request.send(); 
        }
        else{      
            ctx.decodeAudioData(request.response, function (buffer) {
                var source = ctx.createBufferSource(); 
                source.buffer = buffer
                source.connect(ctx.destination); 
                source.start(0);   
            }, onError);
        }
    }
    request.send();    
}

function onError(){
    console.log("Error")
    // loadSound(url_2)
}

    // 測試鍵盤快捷鍵
    window.addEventListener("keydown", torandomTest, false);
    function torandomTest(e) {
        var keyID = e.code;
        if (keyID === 'KeyQ') {
           
            loadSound(url,url_2)
 
        };
        if (keyID === 'KeyW') {
            nextWord()
        };
        if (keyID === 'KeyE') {
           
        };
        if (keyID === 'KeyR') {
            
        }
        if (keyID === 'KeyT') {
            
        }
        if (keyID === 'KeyY') {
            
        }

    }









</script>
</html>